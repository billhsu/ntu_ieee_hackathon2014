<body>
    <video id="video" width="1" height="1" autoplay></video>
    <canvas id="canvas_stream" width="640" height="480"></canvas>
    <button id="calc1">Calculate ring size1</button>
    <button id="calc2">Calculate ring size2</button>
    <button id="calc3">Calculate ring size</button>
    <script>
    // Put event listeners into place
    window.addEventListener("DOMContentLoaded", function() {
        // Grab elements, create settings, etc.
        var canvas_stream = document.getElementById("canvas_stream"),
            context_stream = canvas_stream.getContext("2d"),
            video = document.getElementById("video"),
            videoObj = {
                "video": true
            },
            errBack = function(error) {
                console.log("Video capture error: ", error.code);
            };
        context_stream.translate(canvas_stream.width, 0);
        // flip canvas_stream horizontally 
        context_stream.scale(-1, 1);
        // Put video listeners into place
        if (navigator.getUserMedia) { // Standard
            navigator.getUserMedia(videoObj, function(stream) {
                video.src = stream;
                video.play();
            }, errBack);
        } else if (navigator.webkitGetUserMedia) { // WebKit-prefixed
            navigator.webkitGetUserMedia(videoObj, function(stream) {
                video.src = window.webkitURL.createObjectURL(stream);
                video.play();
            }, errBack);
        } else if (navigator.mozGetUserMedia) { // WebKit-prefixed
            navigator.mozGetUserMedia(videoObj, function(stream) {
                video.src = window.URL.createObjectURL(stream);
                video.play();
            }, errBack);
        }

        // Trigger photo take
        document.getElementById("calc1").addEventListener("click", function() {
            var imgData = context_stream.getImageData(0, 0, 640, 480).data;
            var startPoint = 347 * 640 * 4 + 490 * 4;
            var endPoint = 347 * 640 * 4 + 590 * 4
            for (var i = startPoint; i < end; i += 4) {
                imgData.data[i] = 255 - imgData.data[i];
                imgData.data[i + 1] = 255 - imgData.data[i + 1];
                imgData.data[i + 2] = 255 - imgData.data[i + 2];
                imgData.data[i + 3] = 255;
            }
        });
        // Trigger photo take
        document.getElementById("calc2").addEventListener("click", function() {
            var image = context_stream.getImageData(0, 0, 640, 480).data;
        });

        setInterval(function() {
            context_stream.drawImage(video, 0, 0, 640, 480);
            context_stream.lineWidth = "1";
            context_stream.strokeStyle = "green";
            context_stream.rect((320 - 171), (240 - 108), 171 * 2, 108 * 2);
            context_stream.stroke();
            context_stream.beginPath();
            context_stream.strokeStyle = "red";
            context_stream.moveTo(640 - (320 - 171), 240 + 108);
            context_stream.lineTo(640 - (320 - 171) + 100, 240 + 108);
            context_stream.stroke();
        }, 100);
    }, false);
    </script>
</body>